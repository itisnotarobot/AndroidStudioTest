<div><p style="margin:0;"><font face="宋体"><span style="font-family: Arial; font-size: 14px;"><b>期中实验：NotePad记事本应用功能扩展</b></span></font></p><p style="margin:0;"><span style="font-family: Arial; font-size: 14px;">NotePad</span></p><p style="margin:0;"><font face="宋体"><span style="font-family: Arial; font-size: 14px;">一共包含了6个类，其中4个Activity，一个ContentProvider，还有一个数据契约类。</span></font></p><p style="margin:0;"><font face="宋体"><span style="font-family: Arial; font-size: 14px;">NotesList 应用程序的入口，笔记本的首页面会显示笔记的列表</span></font></p><p style="margin:0;"><font face="宋体"><span style="font-family: Arial; font-size: 14px;">NoteEditor 编辑笔记内容的Activity</span></font></p><p style="margin:0;"><font face="宋体"><span style="font-family: Arial; font-size: 14px;">TitleEditor 编辑笔记标题的Activity</span></font></p><p style="margin:0;"><font face="宋体"><span style="font-family: Arial; font-size: 14px;">NotesLiveFolder ContentProvider的LiveFolder（实时文件夹），这个功能在Android API 14后被废弃，不再支持。</span></font></p><div style="margin:0;"><font face="宋体"><span style="font-family: Arial; font-size: 14px;">NotePadProvider 这是笔记本应用的ContentProvider，也是整个应用的关键所在</span></font></div><div style="margin:0;"><hr /></div><div style="margin:0;"><div><span style="color: rgb(38, 38, 38); font-family: Arial; font-size: 14px;"><b>NoteList界面中笔记条目增加时间戳显示</b></span></div><div>首先在笔记内容下方添加一个textview用于显示时间</div><div><pre style="background-color:#2b2b2b;color:#a9b7c6;font-family:'JetBrains Mono',monospace;font-size:9.8pt;"><span style="color:#e8ba36;">&lt;</span><span style="color:#e8bf6a;">LinearLayout </span><span style="color:#bababa;">xmlns:</span><span style="color:#9876aa;">android</span><span style="color:#6a8759;">="http://schemas.android.com/apk/res/android"<br />    </span><span style="color:#9876aa;">android</span><span style="color:#bababa;">:orientation</span><span style="color:#6a8759;">="vertical" </span><span style="color:#9876aa;">android</span><span style="color:#bababa;">:layout_width</span><span style="color:#6a8759;">="match_parent"<br />    </span><span style="color:#9876aa;">android</span><span style="color:#bababa;">:layout_height</span><span style="color:#6a8759;">="match_parent"<br />    </span><span style="color:#9876aa;">android</span><span style="color:#bababa;">:paddingLeft</span><span style="color:#6a8759;">="10dp"<br />    </span><span style="color:#9876aa;">android</span><span style="color:#bababa;">:paddingRight</span><span style="color:#6a8759;">="10dp"<br />    </span><span style="color:#9876aa;">android</span><span style="color:#bababa;">:paddingTop</span><span style="color:#6a8759;">="5dp"<br />    </span><span style="color:#9876aa;">android</span><span style="color:#bababa;">:paddingBottom</span><span style="color:#6a8759;">="12dp"<br />    </span><span style="color:#9876aa;">android</span><span style="color:#bababa;">:background</span><span style="color:#6a8759;">="@drawable/note_shape"<br />    </span><span style="color:#9876aa;">android</span><span style="color:#bababa;">:outlineAmbientShadowColor</span><span style="color:#6a8759;">="@color/black"</span><span style="color:#e8ba36;">&gt;<br /><br />    </span><span style="color:#54a857;">&lt;</span><span style="color:#e8bf6a;">TextView<br />        </span><span style="color:#9876aa;">android</span><span style="color:#bababa;">:id</span><span style="color:#6a8759;">="@+id/tv_content"<br />        </span><span style="color:#9876aa;">android</span><span style="color:#bababa;">:layout_width</span><span style="color:#6a8759;">="wrap_content"<br />        </span><span style="color:#9876aa;">android</span><span style="color:#bababa;">:layout_height</span><span style="color:#6a8759;">="wrap_content"<br />        </span><span style="color:#9876aa;">android</span><span style="color:#bababa;">:text</span><span style="color:#6a8759;">="Content"<br />        </span><span style="color:#9876aa;">android</span><span style="color:#bababa;">:textSize</span><span style="color:#6a8759;">="20dp"<br />        </span><span style="color:#9876aa;">android</span><span style="color:#bababa;">:textColor</span><span style="color:#6a8759;">="<span ntes_mm_email="@">@color/black"/&gt;</span></span><br /><span style="color:#6a8759;">        </span><span style="color:#9876aa;">android</span><span style="color:#bababa;">:singleLine</span><span style="color:#6a8759;">="true"</span><span style="color:#54a857;">/&gt;<br /><br />    &lt;</span><span style="color:#e8bf6a;">TextView<br />        </span><span style="color:#9876aa;">android</span><span style="color:#bababa;">:id</span><span style="color:#6a8759;">="@+id/tv_time"<br />        </span><span style="color:#9876aa;">android</span><span style="color:#bababa;">:layout_width</span><span style="color:#6a8759;">="wrap_content"<br />        </span><span style="color:#9876aa;">android</span><span style="color:#bababa;">:layout_height</span><span style="color:#6a8759;">="wrap_content"<br />        </span><span style="color:#9876aa;">android</span><span style="color:#bababa;">:text</span><span style="color:#6a8759;">="Time"<br />        </span><span style="color:#9876aa;">android</span><span style="color:#bababa;">:textSize</span><span style="color:#6a8759;">="16dp"<br />        </span><span style="color:#9876aa;">android</span><span style="color:#bababa;">:textColor</span><span style="color:#6a8759;">="@color/grey"</span><span style="color:#54a857;">/&gt;<br /><br /></span><span style="color:#e8ba36;">&lt;/</span><span style="color:#e8bf6a;">LinearLayout</span><span style="color:#e8ba36;">&gt;</span></pre></div><div>利用updateNode函数获取时间并放置在对应文本框中</div><pre style="background-color:#2b2b2b;color:#a9b7c6;font-family:'JetBrains Mono',monospace;font-size:9.8pt;"><br /><span style="color:#cc7832;">private final void </span><span style="color:#ffc66d;">updateNote</span><span style="color:#e8ba36;">(</span>String text<span style="color:#cc7832;">, </span>String title<span style="color:#e8ba36;">) </span><span style="color:#54a857;">{<br /><br />    </span><span style="color:#808080;">// Sets up a map to contain values to be updated in the provider.<br />    </span>ContentValues values = <span style="color:#cc7832;">new </span>ContentValues<span style="color:#e8ba36;">()</span><span style="color:#cc7832;">;<br />    </span>Long now = Long.<span style="font-style:italic;">valueOf</span><span style="color:#e8ba36;">(</span>System.<span style="font-style:italic;">currentTimeMillis</span><span style="color:#54a857;">()</span><span style="color:#e8ba36;">)</span><span style="color:#cc7832;">;<br />    </span>SimpleDateFormat sf = <span style="color:#cc7832;">new </span>SimpleDateFormat<span style="color:#e8ba36;">(</span><span style="color:#6a8759;">"yy/MM/dd HH:mm"</span><span style="color:#e8ba36;">)</span><span style="color:#cc7832;">;<br />    </span>Date d = <span style="color:#cc7832;">new </span>Date<span style="color:#e8ba36;">(</span>now<span style="color:#e8ba36;">)</span><span style="color:#cc7832;">;<br />    </span>String format = sf.format<span style="color:#e8ba36;">(</span>d<span style="color:#e8ba36;">)</span><span style="color:#cc7832;">;<br />    </span>values.put<span style="color:#e8ba36;">(</span>NotePad.Notes.COLUMN_NAME_MODIFICATION_DATE<span style="color:#cc7832;">, </span>format<span style="color:#e8ba36;">)</span><span style="color:#cc7832;">;<br /></span><span style="color:#54a857;">}</span></pre><div><hr /><b>添加笔记查询功能</b></div><div>首先在菜单栏是添加用于输入的文本框和搜索按钮</div><div><pre style="background-color:#2b2b2b;color:#a9b7c6;font-family:'JetBrains Mono',monospace;font-size:9.8pt;"><span style="color:#54a857;">&lt;</span><span style="color:#e8bf6a;">item<br />    </span><span style="color:#9876aa;">android</span><span style="color:#bababa;">:id</span><span style="color:#6a8759;">="@+id/action_search"<br />    </span><span style="color:#9876aa;">android</span><span style="color:#bababa;">:icon</span><span style="color:#6a8759;">="?attr/menu_search"<br />    </span><span style="color:#9876aa;">app</span><span style="color:#bababa;">:showAsAction</span><span style="color:#6a8759;">="always"<br />    </span><span style="color:#9876aa;">app</span><span style="color:#bababa;">:actionViewClass</span><span style="color:#6a8759;">="androidx.appcompat.widget.SearchView"<br />    </span><span style="color:#9876aa;">android</span><span style="color:#bababa;">:title</span><span style="color:#6a8759;">="Search"<br />    </span><span style="color:#54a857;">/&gt;</span></pre></div><div>搜索功能的实现</div><div><pre style="background-color:#2b2b2b;color:#a9b7c6;font-family:'JetBrains Mono',monospace;font-size:9.8pt;"><span style="color:#cc7832;">private void </span><span style="color:#ffc66d;">SearchView</span><span style="color:#e8ba36;">()</span><span style="color:#54a857;">{<br />    </span>searchView=findViewById<span style="color:#e8ba36;">(</span>R.id.sv<span style="color:#e8ba36;">)</span><span style="color:#cc7832;">;<br />    </span><span style="color:#808080;">// a display model<br />    </span>searchView.onActionViewExpanded<span style="color:#e8ba36;">()</span><span style="color:#cc7832;">;<br />    </span><span style="color:#808080;">//default display<br />    </span>searchView.setQueryHint<span style="color:#e8ba36;">(</span><span style="color:#6a8759;">"</span><span style="color:#6a8759;font-family:'宋体',monospace;">搜索笔记</span><span style="color:#6a8759;">"</span><span style="color:#e8ba36;">)</span><span style="color:#cc7832;">;<br />    </span><span style="color:#808080;">//display submit button<br />    </span>searchView.setSubmitButtonEnabled<span style="color:#e8ba36;">(</span><span style="color:#cc7832;">true</span><span style="color:#e8ba36;">)</span><span style="color:#cc7832;">;<br />    </span><span style="color:#808080;">//implement SearchView TextListener<br />    </span>searchView.setOnQueryTextListener<span style="color:#e8ba36;">(</span><span style="color:#cc7832;">new </span>SearchView.OnQueryTextListener<span style="color:#54a857;">() </span><span style="color:#359ff4;">{<br />        </span><span style="color:#808080;">// when text has been submitted<br />        </span><span style="color:#bbb529;">@Override<br />        </span><span style="color:#cc7832;">public boolean </span><span style="color:#ffc66d;">onQueryTextSubmit</span><span style="color:#54a857;">(</span>String s<span style="color:#54a857;">) </span><span style="color:#5060bb;">{<br />            </span><span style="color:#cc7832;">return false;<br />        </span><span style="color:#5060bb;">}<br />        </span><span style="color:#808080;">// when text is changing<br />        </span><span style="color:#bbb529;">@Override<br />        </span><span style="color:#cc7832;">public boolean </span><span style="color:#ffc66d;">onQueryTextChange</span><span style="color:#54a857;">(</span>String s<span style="color:#54a857;">) </span><span style="color:#5060bb;">{<br />            </span><span style="color:#cc7832;">if</span><span style="color:#54a857;">(</span>!s.equals<span style="color:#359ff4;">(</span><span style="color:#6a8759;">""</span><span style="color:#359ff4;">)</span><span style="color:#54a857;">)</span><span style="color:#179387;">{<br />                </span>String selection=NotePad.Notes.COLUMN_NAME_TITLE+<span style="color:#6a8759;">" GLOB '*"</span>+s+<span style="color:#6a8759;">"*'"</span><span style="color:#cc7832;">;</span><span style="color:#808080;">//query selection condition<br />                </span>updatecursor = getContentResolver<span style="color:#359ff4;">()</span>.query<span style="color:#359ff4;">(<br />                        </span>getIntent<span style="color:#5060bb;">()</span>.getData<span style="color:#5060bb;">()</span><span style="color:#cc7832;">,            <br />                        </span>PROJECTION<span style="color:#cc7832;">,                      <br />                        </span>selection<span style="color:#cc7832;">,                            <br />                        null,                             <br />                        </span>NotePad.Notes.DEFAULT_SORT_ORDER  <br />                <span style="color:#359ff4;">)</span><span style="color:#cc7832;">;<br />            </span><span style="color:#179387;">}<br />            </span><span style="color:#cc7832;">else </span><span style="color:#179387;">{<br />                </span>updatecursor = getContentResolver<span style="color:#359ff4;">()</span>.query<span style="color:#359ff4;">(<br />                        </span>getIntent<span style="color:#5060bb;">()</span>.getData<span style="color:#5060bb;">()</span><span style="color:#cc7832;">,           <br />                        </span>PROJECTION<span style="color:#cc7832;">,                      <br />                        null,                   <br />                        null,                            <br />                        </span>NotePad.Notes.DEFAULT_SORT_ORDER  <br />                <span style="color:#359ff4;">)</span><span style="color:#cc7832;">;<br />            </span><span style="color:#179387;">}<br />            </span><span style="color:#808080;">// change adapter from SimpleCursorAdapter cursor<br />            </span>adapter.swapCursor<span style="color:#54a857;">(</span>updatecursor<span style="color:#54a857;">)</span><span style="color:#cc7832;">;<br />            </span><span style="color:#808080;">// adapter.notifyDataSetChanged();<br />            </span><span style="color:#cc7832;">return false;<br />        </span><span style="color:#5060bb;">}<br />    </span><span style="color:#359ff4;">}</span><span style="color:#e8ba36;">)</span><span style="color:#cc7832;">;</span></pre><p class="MsoNormal"><span style="font-family: 宋体; font-size: 10.5pt;">在主界面点击查询可以进行关键字查询<o:p></o:p></span></p></div></div><img src="https://github.com/itisnotarobot/AndroidStudioTest/blob/main/%E6%9C%9F%E4%B8%AD-Notepad/img/pic1.png" /></div><div><p class="MsoNormal"><span style="mso-spacerun:'yes';font-family:宋体;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri;mso-bidi-font-family:'Times New Roman';font-size:10.5000pt;
mso-font-kerning:1.0000pt;"><font face="宋体">输入</font><font face="Calibri">1</font><font face="宋体">查询结果如下</font></span><span style="mso-spacerun:'yes';font-family:Calibri;mso-fareast-font-family:宋体;
mso-bidi-font-family:'Times New Roman';font-size:10.5000pt;mso-font-kerning:1.0000pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="mso-spacerun:'yes';font-family:宋体;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri;mso-bidi-font-family:'Times New Roman';font-size:10.5000pt;
mso-font-kerning:1.0000pt;"></div><img src="https://github.com/itisnotarobot/AndroidStudioTest/blob/main/%E6%9C%9F%E4%B8%AD-Notepad/img/pic2.png" /></div></span></p><hr /><b>UI美化</b></div><div>切换夜晚模式</div><div><pre style="background-color:#2b2b2b;color:#a9b7c6;font-family:'JetBrains Mono',monospace;font-size:9.8pt;"><span style="color:#cc7832;">import </span>android.content.BroadcastReceiver<span style="color:#cc7832;">;<br />import </span>android.content.Context<span style="color:#cc7832;">;<br />import </span>android.content.Intent<span style="color:#cc7832;">;<br />import </span>android.content.IntentFilter<span style="color:#cc7832;">;<br />import </span>android.content.SharedPreferences<span style="color:#cc7832;">;<br />import </span>android.os.Bundle<span style="color:#cc7832;">;<br />import </span>android.preference.PreferenceManager<span style="color:#cc7832;">;<br />import </span>android.util.TypedValue<span style="color:#cc7832;">;<br /><br />import </span>androidx.appcompat.app.AppCompatActivity<span style="color:#cc7832;">;<br /><br />import </span>com.example.biji.R<span style="color:#cc7832;">;<br /><br />public class </span>BaseActivity <span style="color:#cc7832;">extends </span>AppCompatActivity <span style="color:#e8ba36;">{<br />    </span><span style="color:#bbb529;">@Override<br />    </span><span style="color:#cc7832;">protected void </span><span style="color:#ffc66d;">onCreate</span><span style="color:#e8ba36;">(</span>Bundle savedInstanceState<span style="color:#e8ba36;">)</span><span style="color:#54a857;">{<br />        </span><span style="color:#cc7832;">super</span>.onCreate<span style="color:#e8ba36;">(</span>savedInstanceState<span style="color:#e8ba36;">)</span><span style="color:#cc7832;">;<br />        </span>setNightMode<span style="color:#e8ba36;">()</span><span style="color:#cc7832;">;<br />    </span><span style="color:#54a857;">}<br /><br />    </span><span style="color:#cc7832;">public boolean </span><span style="color:#ffc66d;">isNightMode</span><span style="color:#e8ba36;">()</span><span style="color:#54a857;">{<br />        </span>SharedPreferences sharedPreferences = PreferenceManager.<span style="font-style:italic;">getDefaultSharedPreferences</span><span style="color:#e8ba36;">(</span>getBaseContext<span style="color:#54a857;">()</span><span style="color:#e8ba36;">)</span><span style="color:#cc7832;">;<br />        return </span>sharedPreferences.getBoolean<span style="color:#e8ba36;">(</span><span style="color:#6a8759;">"nightMode"</span><span style="color:#cc7832;">, false</span><span style="color:#e8ba36;">)</span><span style="color:#cc7832;">;<br />    </span><span style="color:#54a857;">}<br />    </span><span style="color:#cc7832;">public void </span><span style="color:#ffc66d;">setNightMode</span><span style="color:#e8ba36;">()</span><span style="color:#54a857;">{<br />        </span>setTheme<span style="color:#e8ba36;">(</span>R.style.<span style="color:#9876aa;font-style:italic;">DayTheme</span><span style="color:#e8ba36;">)</span><span style="color:#cc7832;">;<br /><br />    </span><span style="color:#54a857;">}<br /></span><span style="color:#e8ba36;">}<br /></span></pre></div></div><div><p class="MsoNormal"><span style="font-family: Arial; font-size: 14px;">左上角进入设置<o:p></o:p></span></p></div><div></div><img src="https://github.com/itisnotarobot/AndroidStudioTest/blob/main/%E6%9C%9F%E4%B8%AD-Notepad/img/pic3.png" /></div></div><div><p class="MsoNormal"><span style="font-family: Arial; font-size: 14px;">选择开启黑夜模式<o:p></o:p></span></p><p class="MsoNormal"></div><img src="https://github.com/itisnotarobot/AndroidStudioTest/blob/main/%E6%9C%9F%E4%B8%AD-Notepad/img/pic4.png" /></div></p><p class="MsoNormal">效果如下</p><p class="MsoNormal"></div><img src="https://github.com/itisnotarobot/AndroidStudioTest/blob/main/%E6%9C%9F%E4%B8%AD-Notepad/img/pic5.png" /></div></p></div><br /><br /><br /></div>
